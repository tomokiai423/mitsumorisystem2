<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    /* ==================== CSS Variables ==================== */
    :root {
      --color-primary: #0f172a;
      --color-secondary: #334155;
      --color-muted: #64748b;
      --color-light: #94a3b8;
      --color-border: #e2e8f0;
      --color-bg: #ffffff;
      --color-bg-subtle: #f8fafc;
      --color-accent: #2563eb;
      --color-accent-light: #eff6ff;
      --color-success: #059669;
      --color-warning: #d97706;
      --color-warning-bg: #fffbeb;
      --color-error: #dc2626;
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 16px;
      --shadow-sm: 0 1px 2px rgba(0,0,0,0.04);
      --shadow-md: 0 4px 20px rgba(0,0,0,0.06);
      --transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* ==================== Reset & Base ==================== */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      font-size: 16px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    body {
      font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--color-bg-subtle);
      color: var(--color-primary);
      line-height: 1.7;
      min-height: 100vh;
      padding: 24px 16px;
    }

    /* ==================== Container ==================== */
    .container {
      max-width: 640px;
      margin: 0 auto;
      background: var(--color-bg);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
      overflow: hidden;
    }

    /* ==================== Header ==================== */
    .header {
      padding: 48px 40px 40px;
      text-align: center;
      border-bottom: 1px solid var(--color-border);
    }

    .header-badge {
      display: inline-block;
      padding: 6px 14px;
      background: var(--color-accent-light);
      color: var(--color-accent);
      font-size: 12px;
      font-weight: 500;
      border-radius: 100px;
      margin-bottom: 16px;
      letter-spacing: 0.5px;
    }

    .header h1 {
      font-size: 24px;
      font-weight: 600;
      color: var(--color-primary);
      margin-bottom: 8px;
      letter-spacing: -0.5px;
    }

    .header p {
      font-size: 14px;
      color: var(--color-muted);
      font-weight: 400;
    }

    /* ==================== Progress ==================== */
    .progress-section {
      padding: 24px 40px;
      background: var(--color-bg-subtle);
      border-bottom: 1px solid var(--color-border);
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .progress-label {
      font-size: 13px;
      font-weight: 500;
      color: var(--color-secondary);
    }

    .progress-count {
      font-size: 13px;
      color: var(--color-muted);
    }

    .progress-bar-track {
      height: 4px;
      background: var(--color-border);
      border-radius: 2px;
      overflow: hidden;
    }

    .progress-bar-fill {
      height: 100%;
      background: var(--color-accent);
      border-radius: 2px;
      transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* ==================== Form Content ==================== */
    .form-content {
      padding: 40px;
    }

    /* ==================== Step ==================== */
    .step {
      display: none;
    }

    .step.active {
      display: block;
      animation: fadeIn 0.4s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(12px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .step-header {
      margin-bottom: 32px;
    }

    .step-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--color-primary);
      margin-bottom: 8px;
      letter-spacing: -0.3px;
    }

    .step-description {
      font-size: 14px;
      color: var(--color-muted);
      line-height: 1.6;
    }

    /* ==================== Form Elements ==================== */
    .form-group {
      margin-bottom: 28px;
    }

    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 500;
      color: var(--color-secondary);
      margin-bottom: 8px;
    }

    .form-label.required::after {
      content: '*';
      color: var(--color-error);
      margin-left: 4px;
    }

    .form-hint {
      font-size: 13px;
      color: var(--color-muted);
      margin-top: 8px;
      line-height: 1.5;
    }

    /* ==================== Label with Help ==================== */
    .label-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .help-trigger {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      background: var(--color-border);
      border-radius: 50%;
      font-size: 11px;
      font-weight: 600;
      color: var(--color-muted);
      cursor: help;
      transition: var(--transition);
      position: relative;
    }

    .help-trigger:hover {
      background: var(--color-secondary);
      color: white;
    }

    .help-trigger:hover .tooltip {
      opacity: 1;
      visibility: visible;
      transform: translateX(-50%) translateY(0);
    }

    .tooltip {
      position: absolute;
      bottom: calc(100% + 10px);
      left: 50%;
      transform: translateX(-50%) translateY(4px);
      background: var(--color-primary);
      color: white;
      padding: 10px 14px;
      border-radius: var(--radius-sm);
      font-size: 12px;
      font-weight: 400;
      line-height: 1.5;
      white-space: normal;
      width: 240px;
      opacity: 0;
      visibility: hidden;
      transition: var(--transition);
      z-index: 100;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .tooltip::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 6px solid transparent;
      border-top-color: var(--color-primary);
    }

    /* ==================== Input Fields ==================== */
    .form-input,
    .form-select,
    .form-textarea {
      width: 100%;
      padding: 14px 16px;
      font-size: 15px;
      font-family: inherit;
      color: var(--color-primary);
      background: var(--color-bg);
      border: 1.5px solid var(--color-border);
      border-radius: var(--radius-md);
      transition: var(--transition);
      outline: none;
    }

    .form-input:hover,
    .form-select:hover,
    .form-textarea:hover {
      border-color: var(--color-light);
    }

    .form-input:focus,
    .form-select:focus,
    .form-textarea:focus {
      border-color: var(--color-accent);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .form-input::placeholder,
    .form-textarea::placeholder {
      color: var(--color-light);
    }

    .form-select {
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 14px center;
      padding-right: 44px;
    }

    .form-textarea {
      min-height: 160px;
      resize: vertical;
      line-height: 1.6;
    }

    /* ==================== Options (Checkbox/Radio) ==================== */
    .options-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .option-item {
      position: relative;
    }

    .option-item input {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }

    .option-label {
      display: flex;
      align-items: flex-start;
      gap: 14px;
      padding: 16px 18px;
      background: var(--color-bg);
      border: 1.5px solid var(--color-border);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: var(--transition);
    }

    .option-label:hover {
      border-color: var(--color-light);
      background: var(--color-bg-subtle);
    }

    .option-item input:checked + .option-label {
      border-color: var(--color-accent);
      background: var(--color-accent-light);
    }

    .option-indicator {
      flex-shrink: 0;
      width: 20px;
      height: 20px;
      border: 2px solid var(--color-border);
      border-radius: 50%;
      margin-top: 1px;
      transition: var(--transition);
      position: relative;
    }

    .option-indicator.checkbox {
      border-radius: 5px;
    }

    .option-item input:checked + .option-label .option-indicator {
      border-color: var(--color-accent);
      background: var(--color-accent);
    }

    .option-item input:checked + .option-label .option-indicator::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 8px;
      height: 8px;
      background: white;
      border-radius: 50%;
    }

    .option-item input:checked + .option-label .option-indicator.checkbox::after {
      width: 10px;
      height: 6px;
      background: transparent;
      border-left: 2px solid white;
      border-bottom: 2px solid white;
      border-radius: 0;
      transform: translate(-50%, -60%) rotate(-45deg);
    }

    .option-content {
      flex: 1;
      min-width: 0;
    }

    .option-title {
      display: block;
      font-size: 14px;
      font-weight: 500;
      color: var(--color-primary);
      margin-bottom: 2px;
    }

    .option-desc {
      font-size: 13px;
      color: var(--color-muted);
      line-height: 1.5;
    }

    .option-item input:checked + .option-label .option-title {
      color: var(--color-accent);
    }

    /* ==================== Warning Box ==================== */
    .warning-box {
      background: var(--color-warning-bg);
      border: 1px solid #fcd34d;
      border-radius: var(--radius-md);
      padding: 16px 18px;
      margin-bottom: 24px;
    }

    .warning-box-title {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      font-weight: 500;
      color: #92400e;
      margin-bottom: 6px;
    }

    .warning-box-text {
      font-size: 13px;
      color: #a16207;
      line-height: 1.6;
    }

    /* ==================== NG Filter Style ==================== */
    .ng-option .option-label {
      background: var(--color-warning-bg);
      border-color: #fcd34d;
    }

    .ng-option .option-label:hover {
      background: #fef3c7;
      border-color: #f59e0b;
    }

    .ng-option input:checked + .option-label {
      background: #fef3c7;
      border-color: #f59e0b;
    }

    .ng-option input:checked + .option-label .option-indicator {
      border-color: #f59e0b;
      background: #f59e0b;
    }

    .ng-option input:checked + .option-label .option-title {
      color: #92400e;
    }

    /* ==================== Section Divider ==================== */
    .section-divider {
      height: 1px;
      background: var(--color-border);
      margin: 32px 0;
      border: none;
    }

    .section-label {
      font-size: 11px;
      font-weight: 600;
      color: var(--color-muted);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 20px;
    }

    /* ==================== Character Counter ==================== */
    .char-counter {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      color: var(--color-muted);
      margin-top: 10px;
    }

    .char-counter.warning {
      color: var(--color-error);
    }

    .char-counter.success {
      color: var(--color-success);
    }

    .char-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: currentColor;
    }

    /* ==================== Buttons ==================== */
    .form-actions {
      display: flex;
      gap: 12px;
      margin-top: 40px;
      padding-top: 32px;
      border-top: 1px solid var(--color-border);
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 14px 28px;
      font-size: 15px;
      font-weight: 500;
      font-family: inherit;
      border: none;
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: var(--transition);
      text-decoration: none;
    }

    .btn-secondary {
      background: var(--color-bg-subtle);
      color: var(--color-secondary);
      border: 1.5px solid var(--color-border);
    }

    .btn-secondary:hover {
      background: var(--color-border);
    }

    .btn-primary {
      flex: 1;
      background: var(--color-primary);
      color: white;
    }

    .btn-primary:hover {
      background: #1e293b;
      transform: translateY(-1px);
    }

    .btn-success {
      flex: 1;
      background: var(--color-success);
      color: white;
    }

    .btn-success:hover:not(:disabled) {
      background: #047857;
      transform: translateY(-1px);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .btn-icon {
      font-size: 18px;
    }

    /* ==================== Result Screens ==================== */
    .screen-center {
      text-align: center;
      padding: 60px 40px;
    }

    .screen-icon {
      font-size: 56px;
      margin-bottom: 24px;
      line-height: 1;
    }

    .screen-title {
      font-size: 22px;
      font-weight: 600;
      color: var(--color-primary);
      margin-bottom: 12px;
    }

    .screen-text {
      font-size: 14px;
      color: var(--color-muted);
      line-height: 1.8;
      max-width: 360px;
      margin: 0 auto;
    }

    .rejection-message {
      background: var(--color-bg-subtle);
      border-radius: var(--radius-md);
      padding: 24px;
      margin: 24px 0;
      text-align: left;
      font-size: 14px;
      color: var(--color-secondary);
      line-height: 1.8;
    }

    .rejection-screen,
    .loading-screen,
    .result-screen {
      display: none;
    }

    /* ==================== Loading ==================== */
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 3px solid var(--color-border);
      border-top-color: var(--color-accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* ==================== Responsive ==================== */
    @media (max-width: 600px) {
      body {
        padding: 12px;
      }

      .header {
        padding: 36px 24px 32px;
      }

      .header h1 {
        font-size: 20px;
      }

      .progress-section {
        padding: 20px 24px;
      }

      .form-content {
        padding: 28px 24px;
      }

      .option-label {
        padding: 14px 16px;
      }

      .form-actions {
        flex-direction: column;
      }

      .btn-secondary {
        order: 2;
      }

      .tooltip {
        width: 200px;
        left: 0;
        transform: translateX(0) translateY(4px);
      }

      .tooltip::after {
        left: 20px;
        transform: none;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- ==================== Header ==================== -->
    <header class="header">
      <span class="header-badge">ç„¡æ–™ç›¸è«‡</span>
      <h1>ã‚·ã‚¹ãƒ†ãƒ é–‹ç™º ãŠå•ã„åˆã‚ã›</h1>
      <p>Google Apps Script ã«ã‚ˆã‚‹æ¥­å‹™åŠ¹ç‡åŒ–ã‚’æ”¯æ´ã—ã¾ã™</p>
    </header>

    <!-- ==================== Progress ==================== -->
    <div class="progress-section" id="progressSection">
      <div class="progress-header">
        <span class="progress-label" id="progressLabel">ç¢ºèªäº‹é …</span>
        <span class="progress-count"><span id="currentStep">1</span> / 5</span>
      </div>
      <div class="progress-bar-track">
        <div class="progress-bar-fill" id="progressBar" style="width: 20%;"></div>
      </div>
    </div>

    <!-- ==================== Form ==================== -->
    <div class="form-content">
      <form id="estimateForm">

        <!-- ==================== Step 1 ==================== -->
        <div class="step active" data-step="1">
          <div class="step-header">
            <h2 class="step-title">å¯¾å¿œå¯èƒ½ã‹ã®ç¢ºèª</h2>
            <p class="step-description">ã¾ãšã€ã”è¦æœ›ãŒå½“ã‚µãƒ¼ãƒ“ã‚¹ã§å¯¾å¿œã§ãã‚‹ã‹ç¢ºèªã•ã›ã¦ãã ã•ã„ã€‚</p>
          </div>

          <div class="warning-box">
            <div class="warning-box-title">
              <span>âš ï¸</span>
              <span>ã”ç¢ºèªãã ã•ã„</span>
            </div>
            <p class="warning-box-text">ä»¥ä¸‹ã«è©²å½“ã™ã‚‹å ´åˆã€æŠ€è¡“çš„ãªåˆ¶ç´„ã«ã‚ˆã‚Šå¯¾å¿œãŒé›£ã—ããªã‚Šã¾ã™ã€‚è©²å½“ã™ã‚‹ã‚‚ã®ãŒã‚ã‚Œã°ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚</p>
          </div>

          <div class="form-group">
            <div class="options-list">
              <div class="option-item ng-option">
                <input type="checkbox" name="ngFilter" value="native_app" id="ng1">
                <label class="option-label" for="ng1">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">ã‚¹ãƒãƒ›ã‚¢ãƒ—ãƒªãŒå¿…è¦</span>
                    <span class="option-desc">App Store ã‚„ Google Play ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã‚¢ãƒ—ãƒª</span>
                  </div>
                </label>
              </div>
              <div class="option-item ng-option">
                <input type="checkbox" name="ngFilter" value="public_system" id="ng2">
                <label class="option-label" for="ng2">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">ä¸€èˆ¬å…¬é–‹ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ </span>
                    <span class="option-desc">ä¸ç‰¹å®šå¤šæ•°ãŒåˆ©ç”¨ã™ã‚‹ Web ã‚µãƒ¼ãƒ“ã‚¹ã‚„ãƒãƒ¼ã‚¿ãƒ«ã‚µã‚¤ãƒˆ</span>
                  </div>
                </label>
              </div>
              <div class="option-item ng-option">
                <input type="checkbox" name="ngFilter" value="existing_system" id="ng3">
                <label class="option-label" for="ng3">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®æ”¹ä¿®</span>
                    <span class="option-desc">kintoneã€Salesforceã€freee ç­‰ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</span>
                  </div>
                </label>
              </div>
              <div class="option-item ng-option">
                <input type="checkbox" name="ngFilter" value="realtime_sync" id="ng4">
                <label class="option-label" for="ng4">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸãŒå¿…é ˆ</span>
                    <span class="option-desc">ãƒãƒ£ãƒƒãƒˆã€åœ¨åº«ã®å³æ™‚åæ˜ ãªã©ç¬æ™‚ã®æ›´æ–°ãŒå¿…è¦</span>
                  </div>
                </label>
              </div>
              <div class="option-item ng-option">
                <input type="checkbox" name="ngFilter" value="external_users" id="ng5">
                <label class="option-label" for="ng5">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä»¥å¤–ã®æ–¹ã‚‚åˆ©ç”¨</span>
                    <span class="option-desc">Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æŒãŸãªã„å¤–éƒ¨ã®æ–¹ãŒæ“ä½œã™ã‚‹å ´åˆ</span>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <p class="form-hint">ğŸ’¡ è©²å½“ã™ã‚‹ã‚‚ã®ãŒãªã‘ã‚Œã°ã€ãã®ã¾ã¾æ¬¡ã¸ãŠé€²ã¿ãã ã•ã„</p>

          <div class="form-actions">
            <button type="button" class="btn btn-primary" onclick="nextStep()">
              æ¬¡ã¸é€²ã‚€
              <span class="btn-icon">â†’</span>
            </button>
          </div>
        </div>

        <!-- ==================== Step 2 ==================== -->
        <div class="step" data-step="2">
          <div class="step-header">
            <h2 class="step-title">ãŠå®¢æ§˜æƒ…å ±</h2>
            <p class="step-description">ã”é€£çµ¡å…ˆã¨ä¼šç¤¾æƒ…å ±ã‚’ãŠèã‹ã›ãã ã•ã„ã€‚</p>
          </div>

          <div class="section-label">åŸºæœ¬æƒ…å ±</div>

          <div class="form-group">
            <label class="form-label required">ä¼šç¤¾åãƒ»å±‹å·</label>
            <input type="text" class="form-input" id="companyName" required placeholder="ä¾‹ï¼šæ ªå¼ä¼šç¤¾ã€‡ã€‡">
            <p class="form-hint">å€‹äººäº‹æ¥­ä¸»ã®æ–¹ã¯å±‹å·ã€ãªã‘ã‚Œã°ãŠåå‰ã§OK</p>
          </div>

          <div class="form-group">
            <label class="form-label required">ã”æ‹…å½“è€…å</label>
            <input type="text" class="form-input" id="contactName" required placeholder="ä¾‹ï¼šå±±ç”° å¤ªéƒ">
          </div>

          <div class="form-group">
            <label class="form-label required">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
            <input type="email" class="form-input" id="email" required placeholder="ä¾‹ï¼šyamada@example.com">
            <p class="form-hint">åˆ¤å®šçµæœã‚’ã“ã¡ã‚‰ã«ãŠé€ã‚Šã—ã¾ã™</p>
          </div>

          <div class="form-group">
            <label class="form-label">é›»è©±ç•ªå·ï¼ˆä»»æ„ï¼‰</label>
            <input type="tel" class="form-input" id="phone" placeholder="ä¾‹ï¼š03-1234-5678">
          </div>

          <hr class="section-divider">
          <div class="section-label">ä¼šç¤¾æƒ…å ±</div>

          <div class="form-group">
            <label class="form-label required">äº‹æ¥­å½¢æ…‹</label>
            <select class="form-select" id="businessType" required>
              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              <option value="å€‹äººäº‹æ¥­ä¸»">å€‹äººäº‹æ¥­ä¸»</option>
              <option value="æ³•äºº">æ³•äºº</option>
            </select>
          </div>

          <div class="form-group">
            <div class="label-row">
              <label class="form-label required">å¹´å•†ï¼ˆå£²ä¸Šé«˜ï¼‰</label>
              <span class="help-trigger">?
                <span class="tooltip">ç›´è¿‘1å¹´é–“ã®å£²ä¸Šé«˜ã®ç›®å®‰ã§ã™ã€‚ã ã„ãŸã„ã§æ§‹ã„ã¾ã›ã‚“ã€‚</span>
              </span>
            </div>
            <select class="form-select" id="annualRevenue" required>
              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              <option value="500ä¸‡å††æœªæº€">500ä¸‡å††æœªæº€</option>
              <option value="500ä¸‡ã€œ1,000ä¸‡å††">500ä¸‡ã€œ1,000ä¸‡å††</option>
              <option value="1,000ä¸‡ã€œ1,500ä¸‡å††">1,000ä¸‡ã€œ1,500ä¸‡å††</option>
              <option value="1,500ä¸‡ã€œ3,000ä¸‡å††">1,500ä¸‡ã€œ3,000ä¸‡å††</option>
              <option value="3,000ä¸‡ã€œ5,000ä¸‡å††">3,000ä¸‡ã€œ5,000ä¸‡å††</option>
              <option value="5,000ä¸‡ã€œ1å„„å††">5,000ä¸‡ã€œ1å„„å††</option>
              <option value="1å„„ã€œ3å„„å††">1å„„ã€œ3å„„å††</option>
              <option value="3å„„å††ä»¥ä¸Š">3å„„å††ä»¥ä¸Š</option>
            </select>
          </div>

          <div class="form-group">
            <div class="label-row">
              <label class="form-label required">æ±ºç®—ãƒ»ç¢ºå®šç”³å‘Š</label>
              <span class="help-trigger">?
                <span class="tooltip">ç›´è¿‘ã®æ±ºç®—ãƒ»ç¢ºå®šç”³å‘ŠãŒå®Œäº†ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã§ã™ã€‚</span>
              </span>
            </div>
            <select class="form-select" id="taxFiled" required>
              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              <option value="ã¯ã„">å®Œäº†ã—ã¦ã„ã‚‹</option>
              <option value="ã„ã„ãˆ">ã¾ã  / å‰µæ¥­1å¹´æœªæº€</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label required">å¾“æ¥­å“¡æ•°ï¼ˆãƒ‘ãƒ¼ãƒˆãƒ»ã‚¢ãƒ«ãƒã‚¤ãƒˆå«ã‚€ï¼‰</label>
            <input type="number" class="form-input" id="employeeCount" min="0" required placeholder="ä¾‹ï¼š5">
            <p class="form-hint">ã”æœ¬äººã®ã¿ã®å ´åˆã¯ã€Œ1ã€</p>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary" onclick="prevStep()">â† æˆ»ã‚‹</button>
            <button type="button" class="btn btn-primary" onclick="nextStep()">æ¬¡ã¸é€²ã‚€ â†’</button>
          </div>
        </div>

        <!-- ==================== Step 3 ==================== -->
        <div class="step" data-step="3">
          <div class="step-header">
            <h2 class="step-title">ä½œã‚ŠãŸã„ã‚·ã‚¹ãƒ†ãƒ ã®ç¨®é¡</h2>
            <p class="step-description">è¿‘ã„ã‚‚ã®ã‚’é¸ã‚“ã§ãã ã•ã„ï¼ˆè¤‡æ•°å¯ï¼‰ã€‚ã´ã£ãŸã‚Šã®ã‚‚ã®ãŒãªãã¦ã‚‚å¤§ä¸ˆå¤«ã§ã™ã€‚</p>
          </div>

          <div class="form-group">
            <div class="options-list">
              <div class="option-item">
                <input type="checkbox" name="category" value="ãƒ‡ãƒ¼ã‚¿é›†è¨ˆãƒ»è»¢è¨˜ã®è‡ªå‹•åŒ–" id="cat1">
                <label class="option-label" for="cat1">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">ãƒ‡ãƒ¼ã‚¿é›†è¨ˆãƒ»è»¢è¨˜ã®è‡ªå‹•åŒ–</span>
                    <span class="option-desc">è¤‡æ•°ã®ã‚·ãƒ¼ãƒˆã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’é›†ã‚ã¦è‡ªå‹•ã§ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="checkbox" name="category" value="ãƒ•ã‚©ãƒ¼ãƒ ãƒ»ç”³è«‹ã‚·ã‚¹ãƒ†ãƒ " id="cat2">
                <label class="option-label" for="cat2">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">ãƒ•ã‚©ãƒ¼ãƒ ãƒ»ç”³è«‹ã‚·ã‚¹ãƒ†ãƒ </span>
                    <span class="option-desc">ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã‚„ç”³è«‹æ›¸ã‚’å—ã‘ä»˜ã‘ã¦ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•æ•´ç†</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="checkbox" name="category" value="æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼" id="cat3">
                <label class="option-label" for="cat3">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</span>
                    <span class="option-desc">ç”³è«‹â†’ä¸Šé•·æ‰¿èªâ†’å®Œäº†ã®æµã‚Œã‚’è‡ªå‹•åŒ–</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="checkbox" name="category" value="é€šçŸ¥ãƒ»ãƒªãƒã‚¤ãƒ³ãƒ‰" id="cat4">
                <label class="option-label" for="cat4">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">é€šçŸ¥ãƒ»ãƒªãƒã‚¤ãƒ³ãƒ‰</span>
                    <span class="option-desc">æœŸé™å‰ã®ãŠçŸ¥ã‚‰ã›ã€å®šæœŸå ±å‘Šãƒ¡ãƒ¼ãƒ«ã®è‡ªå‹•é€ä¿¡</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="checkbox" name="category" value="ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ»ãƒ¬ãƒãƒ¼ãƒˆ" id="cat5">
                <label class="option-label" for="cat5">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ»ãƒ¬ãƒãƒ¼ãƒˆ</span>
                    <span class="option-desc">å£²ä¸Šã‚„KPIã‚’ã‚°ãƒ©ãƒ•ã§è¦‹ãˆã‚‹åŒ–ã€PDFå‡ºåŠ›</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="checkbox" name="category" value="é¡§å®¢ãƒ»æ¡ˆä»¶ç®¡ç†" id="cat6">
                <label class="option-label" for="cat6">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">é¡§å®¢ãƒ»æ¡ˆä»¶ç®¡ç†</span>
                    <span class="option-desc">ãŠå®¢æ§˜æƒ…å ±ã‚„æ¡ˆä»¶ã®é€²æ—ã‚’ä¸€å…ƒç®¡ç†</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="checkbox" name="category" value="å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æº" id="cat7">
                <label class="option-label" for="cat7">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æº</span>
                    <span class="option-desc">Slackã€Chatworkã€LINEã€ä¼šè¨ˆã‚½ãƒ•ãƒˆãªã©ã¨ã®é€£æº</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="checkbox" name="category" value="ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆ" id="cat8">
                <label class="option-label" for="cat8">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆ</span>
                    <span class="option-desc">è¦‹ç©æ›¸ã€è«‹æ±‚æ›¸ã€å¥‘ç´„æ›¸ãªã©ã®è‡ªå‹•ä½œæˆ</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="checkbox" name="category" value="ãã®ä»–" id="cat9">
                <label class="option-label" for="cat9">
                  <span class="option-indicator checkbox"></span>
                  <div class="option-content">
                    <span class="option-title">ãã®ä»–ãƒ»ã‚ã‹ã‚‰ãªã„</span>
                    <span class="option-desc">ä¸Šè¨˜ã«å½“ã¦ã¯ã¾ã‚‰ãªã„ã€ã¾ãŸã¯åˆ¤æ–­ãŒã¤ã‹ãªã„</span>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary" onclick="prevStep()">â† æˆ»ã‚‹</button>
            <button type="button" class="btn btn-primary" onclick="nextStep()">æ¬¡ã¸é€²ã‚€ â†’</button>
          </div>
        </div>

        <!-- ==================== Step 4 ==================== -->
        <div class="step" data-step="4">
          <div class="step-header">
            <h2 class="step-title">ã‚·ã‚¹ãƒ†ãƒ ã®è¦æ¨¡æ„Ÿ</h2>
            <p class="step-description">é–‹ç™ºã®é›£æ˜“åº¦ã‚’åˆ¤æ–­ã™ã‚‹ãŸã‚ã€è¦æ¨¡ã‚’ãŠèã‹ã›ãã ã•ã„ã€‚</p>
          </div>

          <div class="form-group">
            <div class="label-row">
              <label class="form-label required">ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ã†äºº</label>
              <span class="help-trigger">?
                <span class="tooltip">ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿéš›ã«æ“ä½œã™ã‚‹äººã®ç¯„å›²ã§ã™ã€‚</span>
              </span>
            </div>
            <div class="options-list">
              <div class="option-item">
                <input type="radio" name="userType" value="ç¤¾å†…ã®ã¿" id="user1" required>
                <label class="option-label" for="user1">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">ç¤¾å†…ã®ã¿</span>
                    <span class="option-desc">è‡ªç¤¾ã®ç¤¾å“¡ãƒ»ã‚¹ã‚¿ãƒƒãƒ•ã ã‘ãŒä½¿ã†</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="radio" name="userType" value="ç¤¾å¤–ï¼ˆå–å¼•å…ˆç­‰ï¼‰ã‚‚åˆ©ç”¨" id="user2">
                <label class="option-label" for="user2">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">ç¤¾å¤–ã‚‚åˆ©ç”¨</span>
                    <span class="option-desc">å–å¼•å…ˆã‚„ãŠå®¢æ§˜ã‚‚æ“ä½œã™ã‚‹</span>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <div class="form-group">
            <div class="label-row">
              <label class="form-label required">åŒæ™‚ã«ä½¿ã†äººæ•°</label>
              <span class="help-trigger">?
                <span class="tooltip">åŒã˜æ™‚é–“å¸¯ã«åŒæ™‚ã«ã‚·ã‚¹ãƒ†ãƒ ã‚’æ“ä½œã™ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹äººæ•°ã§ã™ã€‚</span>
              </span>
            </div>
            <div class="options-list">
              <div class="option-item">
                <input type="radio" name="concurrentUsers" value="5äººä»¥ä¸‹" id="concurrent1" required>
                <label class="option-label" for="concurrent1">
                  <span class="option-indicator"></span>
                  <div class="option-content"><span class="option-title">5äººä»¥ä¸‹</span></div>
                </label>
              </div>
              <div class="option-item">
                <input type="radio" name="concurrentUsers" value="10äººç¨‹åº¦" id="concurrent2">
                <label class="option-label" for="concurrent2">
                  <span class="option-indicator"></span>
                  <div class="option-content"><span class="option-title">10äººç¨‹åº¦</span></div>
                </label>
              </div>
              <div class="option-item">
                <input type="radio" name="concurrentUsers" value="æ•°åäººä»¥ä¸Š" id="concurrent3">
                <label class="option-label" for="concurrent3">
                  <span class="option-indicator"></span>
                  <div class="option-content"><span class="option-title">æ•°åäººä»¥ä¸Š</span></div>
                </label>
              </div>
            </div>
          </div>

          <div class="form-group">
            <div class="label-row">
              <label class="form-label required">æ‰±ã†ãƒ‡ãƒ¼ã‚¿ã®é‡</label>
              <span class="help-trigger">?
                <span class="tooltip">1è¡Œï¼1ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã¨è€ƒãˆã¦ãã ã•ã„ã€‚</span>
              </span>
            </div>
            <div class="options-list">
              <div class="option-item">
                <input type="radio" name="dataVolume" value="1000è¡Œä»¥ä¸‹" id="data1" required>
                <label class="option-label" for="data1">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">å°‘ãªã‚ï¼ˆ1,000ä»¶ä»¥ä¸‹ï¼‰</span>
                    <span class="option-desc">æœˆæ•°åä»¶ã®å—æ³¨ã€ç¤¾å“¡æ•°ååã®å‹¤æ€ ãªã©</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="radio" name="dataVolume" value="1ä¸‡è¡Œä»¥ä¸‹" id="data2">
                <label class="option-label" for="data2">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">æ™®é€šï¼ˆ1,000ã€œ10,000ä»¶ï¼‰</span>
                    <span class="option-desc">å¹´é–“ã®å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã€æ•°å¹´åˆ†ã®é¡§å®¢ãƒªã‚¹ãƒˆãªã©</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="radio" name="dataVolume" value="1ä¸‡è¡Œä»¥ä¸Š" id="data3">
                <label class="option-label" for="data3">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">å¤šã‚ï¼ˆ10,000ä»¶ä»¥ä¸Šï¼‰</span>
                    <span class="option-desc">å¤§é‡ã®ãƒ­ã‚°ã€éå»ä½•å¹´åˆ†ã‚‚ã®å±¥æ­´ãªã©</span>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label required">å‡¦ç†ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°</label>
            <div class="options-list">
              <div class="option-item">
                <input type="radio" name="processTiming" value="æ‰‹å‹•å®Ÿè¡Œ" id="timing1" required>
                <label class="option-label" for="timing1">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">æ‰‹å‹•ã§å®Ÿè¡Œ</span>
                    <span class="option-desc">ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ãã ã‘å‹•ã</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="radio" name="processTiming" value="å®šæœŸãƒãƒƒãƒ" id="timing2">
                <label class="option-label" for="timing2">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">å®šæœŸçš„ã«è‡ªå‹•å®Ÿè¡Œ</span>
                    <span class="option-desc">æ¯æ—¥æœ9æ™‚ã€æ¯é€±æœˆæ›œãªã©æ±ºã¾ã£ãŸæ™‚é–“ã«å‹•ã</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="radio" name="processTiming" value="ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¿…é ˆ" id="timing3">
                <label class="option-label" for="timing3">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼ˆå³æ™‚ï¼‰</span>
                    <span class="option-desc">ãƒ‡ãƒ¼ã‚¿å…¥åŠ›å¾Œã™ãã«åæ˜ ãŒå¿…è¦</span>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <div class="form-group">
            <div class="label-row">
              <label class="form-label required">æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®ç§»è¡Œ</label>
              <span class="help-trigger">?
                <span class="tooltip">ä»ŠãŠä½¿ã„ã®Excelã‚„ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å¼•ãç¶™ãå¿…è¦ãŒã‚ã‚‹ã‹ã©ã†ã‹ã§ã™ã€‚</span>
              </span>
            </div>
            <div class="options-list">
              <div class="option-item">
                <input type="radio" name="dataMigration" value="ãªã—" id="migration1" required>
                <label class="option-label" for="migration1">
                  <span class="option-indicator"></span>
                  <div class="option-content"><span class="option-title">ãªã—ï¼ˆæ–°è¦ã§OKï¼‰</span></div>
                </label>
              </div>
              <div class="option-item">
                <input type="radio" name="dataMigration" value="ã‚ã‚Šï¼ˆå°‘é‡ï¼‰" id="migration2">
                <label class="option-label" for="migration2">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">ã‚ã‚Šï¼ˆå°‘é‡ï¼‰</span>
                    <span class="option-desc">Excelãƒ•ã‚¡ã‚¤ãƒ«æ•°å€‹ç¨‹åº¦</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="radio" name="dataMigration" value="ã‚ã‚Šï¼ˆå¤§é‡ï¼‰" id="migration3">
                <label class="option-label" for="migration3">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">ã‚ã‚Šï¼ˆå¤§é‡ï¼‰</span>
                    <span class="option-desc">è¤‡æ•°ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã®ç§»è¡Œã€é•·æœŸé–“ã®å±¥æ­´ãªã©</span>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label required">è¦‹ãŸç›®ã®ã“ã ã‚ã‚Š</label>
            <div class="options-list">
              <div class="option-item">
                <input type="radio" name="designRequirement" value="æœ€ä½é™ã§OK" id="design1" required>
                <label class="option-label" for="design1">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">æœ€ä½é™ã§OK</span>
                    <span class="option-desc">ä½¿ãˆã‚Œã°è¦‹ãŸç›®ã¯æ°—ã«ã—ãªã„</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="radio" name="designRequirement" value="ã‚ã‚‹ç¨‹åº¦ãã‚Œã„ã«" id="design2">
                <label class="option-label" for="design2">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">ã‚ã‚‹ç¨‹åº¦ãã‚Œã„ã«</span>
                    <span class="option-desc">è¦‹ã‚„ã™ãæ•´ç†ã•ã‚Œã¦ã„ã‚Œã°OK</span>
                  </div>
                </label>
              </div>
              <div class="option-item">
                <input type="radio" name="designRequirement" value="ã“ã ã‚ã‚ŠãŸã„" id="design3">
                <label class="option-label" for="design3">
                  <span class="option-indicator"></span>
                  <div class="option-content">
                    <span class="option-title">ã“ã ã‚ã‚ŠãŸã„</span>
                    <span class="option-desc">ç¤¾å¤–ã«è¦‹ã›ã‚‹ã®ã§ãƒ‡ã‚¶ã‚¤ãƒ³ã‚‚é‡è¦–</span>
                  </div>
                </label>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary" onclick="prevStep()">â† æˆ»ã‚‹</button>
            <button type="button" class="btn btn-primary" onclick="nextStep()">æ¬¡ã¸é€²ã‚€ â†’</button>
          </div>
        </div>

        <!-- ==================== Step 5 ==================== -->
        <div class="step" data-step="5">
          <div class="step-header">
            <h2 class="step-title">è©³ã—ããŠèã‹ã›ãã ã•ã„</h2>
            <p class="step-description">ä½œã‚ŠãŸã„ã‚·ã‚¹ãƒ†ãƒ ã«ã¤ã„ã¦è©³ã—ãæ•™ãˆã¦ãã ã•ã„ã€‚å…·ä½“çš„ãªã»ã©æ­£ç¢ºã«åˆ¤å®šã§ãã¾ã™ã€‚</p>
          </div>

          <div class="form-group">
            <label class="form-label required">ä½œã‚ŠãŸã„ã‚·ã‚¹ãƒ†ãƒ ã®è©³ç´°ï¼ˆ200æ–‡å­—ä»¥ä¸Šï¼‰</label>
            <textarea class="form-textarea" id="description" required placeholder="ä¾‹ãˆã°â€¦
ãƒ»ä»Šã©ã‚“ãªä½œæ¥­ã‚’ã—ã¦ã„ã¦ã€ä½•ãŒå¤§å¤‰ã‹
ãƒ»ã‚·ã‚¹ãƒ†ãƒ ã§ä½•ã‚’å®Ÿç¾ã—ãŸã„ã‹
ãƒ»ã“ã‚“ãªç”»é¢ãŒã»ã—ã„ã€ã“ã‚“ãªæ©Ÿèƒ½ãŒã»ã—ã„
ãƒ»å‚è€ƒã«ã—ãŸã„ã‚µãƒ¼ãƒ“ã‚¹ã‚„ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã«è¿‘ã„ã‚‚ã®" oninput="updateCharCounter()"></textarea>
            <div class="char-counter" id="charCounter">
              <span class="char-dot"></span>
              <span>0 / 200æ–‡å­—</span>
            </div>
          </div>

          <p class="form-hint">ğŸ’¡ è©³ã—ãæ›¸ã„ã¦ã„ãŸã ãã»ã©ã€ã‚ˆã‚Šæ­£ç¢ºãªåˆ¤å®šãŒã§ãã¾ã™</p>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary" onclick="prevStep()">â† æˆ»ã‚‹</button>
            <button type="submit" class="btn btn-success" id="submitBtn" disabled>é€ä¿¡ã™ã‚‹</button>
          </div>
        </div>
      </form>

      <!-- ==================== Rejection Screen ==================== -->
      <div class="rejection-screen screen-center" id="rejectionScreen">
        <div class="screen-icon">ğŸ™‡</div>
        <h2 class="screen-title">ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“</h2>
        <div class="rejection-message">
          ã”é¸æŠã„ãŸã ã„ãŸå†…å®¹ã¯ã€å½“ã‚µãƒ¼ãƒ“ã‚¹ã®å¯¾å¿œç¯„å›²å¤–ã¨ãªã£ã¦ãŠã‚Šã¾ã™ã€‚<br><br>
          å½“ã‚µãƒ¼ãƒ“ã‚¹ã¯ <strong>Google Apps Script</strong> ã‚’æ´»ç”¨ã—ãŸæ¥­å‹™åŠ¹ç‡åŒ–ãƒ„ãƒ¼ãƒ«ã®é–‹ç™ºã«ç‰¹åŒ–ã—ã¦ãŠã‚Šã€ã‚¹ãƒãƒ›ã‚¢ãƒ—ãƒªã®é–‹ç™ºã‚„æ—¢å­˜ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã«ã¯å¯¾å¿œã—ã¦ãŠã‚Šã¾ã›ã‚“ã€‚<br><br>
          ã”æœŸå¾…ã«æ²¿ãˆãšæã‚Œå…¥ã‚Šã¾ã™ãŒã€ã”ç†è§£ã„ãŸã ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ã€‚
        </div>
        <button class="btn btn-secondary" onclick="location.reload()">æœ€åˆã«æˆ»ã‚‹</button>
      </div>

      <!-- ==================== Loading Screen ==================== -->
      <div class="loading-screen screen-center" id="loadingScreen">
        <div class="loading-spinner"></div>
        <p class="screen-text">AIãŒå†…å®¹ã‚’åˆ†æã—ã¦ã„ã¾ã™â€¦<br>å°‘ã€…ãŠå¾…ã¡ãã ã•ã„</p>
      </div>

      <!-- ==================== Result Screen ==================== -->
      <div class="result-screen screen-center" id="resultScreen">
        <div class="screen-icon" id="resultIcon"></div>
        <h2 class="screen-title" id="resultTitle"></h2>
        <p class="screen-text" id="resultMessage"></p>
      </div>
    </div>
  </div>

  <script>
    let currentStep = 1;
    const totalSteps = 5;
    const MIN_CHAR_COUNT = 200;

    const stepLabels = ['ç¢ºèªäº‹é …', 'ãŠå®¢æ§˜æƒ…å ±', 'ã‚«ãƒ†ã‚´ãƒª', 'è¦æ¨¡æ„Ÿ', 'è©³ç´°å…¥åŠ›'];

    function updateProgress() {
      const progress = (currentStep / totalSteps) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
      document.getElementById('currentStep').textContent = currentStep;
      document.getElementById('progressLabel').textContent = stepLabels[currentStep - 1];
    }

    function showStep(step) {
      document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
      const targetStep = document.querySelector(`.step[data-step="${step}"]`);
      if (targetStep) targetStep.classList.add('active');
      updateProgress();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function validateStep(step) {
      const currentStepEl = document.querySelector(`.step[data-step="${step}"]`);
      const requiredInputs = currentStepEl.querySelectorAll('[required]');

      for (const input of requiredInputs) {
        if (input.type === 'radio') {
          const radioGroup = currentStepEl.querySelectorAll(`[name="${input.name}"]`);
          const isChecked = Array.from(radioGroup).some(r => r.checked);
          if (!isChecked) {
            alert('å¿…é ˆé …ç›®ã‚’é¸æŠã—ã¦ãã ã•ã„');
            return false;
          }
        } else if (input.tagName === 'SELECT') {
          if (!input.value) {
            alert('å¿…é ˆé …ç›®ã‚’é¸æŠã—ã¦ãã ã•ã„');
            input.focus();
            return false;
          }
        } else if (!input.value.trim()) {
          alert('å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
          input.focus();
          return false;
        }
      }

      if (step === 2) {
        const email = document.getElementById('email').value;
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
          alert('æ­£ã—ã„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
          document.getElementById('email').focus();
          return false;
        }
      }

      return true;
    }

    function checkNGFilter() {
      return document.querySelectorAll('input[name="ngFilter"]:checked').length > 0;
    }

    function showRejectionScreen() {
      document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
      document.getElementById('progressSection').style.display = 'none';
      document.getElementById('rejectionScreen').style.display = 'block';
    }

    function nextStep() {
      if (!validateStep(currentStep)) return;
      if (currentStep === 1 && checkNGFilter()) {
        showRejectionScreen();
        return;
      }
      if (currentStep < totalSteps) {
        currentStep++;
        showStep(currentStep);
      }
    }

    function prevStep() {
      if (currentStep > 1) {
        currentStep--;
        showStep(currentStep);
      }
    }

    function updateCharCounter() {
      const description = document.getElementById('description');
      const counter = document.getElementById('charCounter');
      const submitBtn = document.getElementById('submitBtn');
      const charCount = description.value.length;

      counter.innerHTML = `<span class="char-dot"></span><span>${charCount} / ${MIN_CHAR_COUNT}æ–‡å­—</span>`;

      if (charCount >= MIN_CHAR_COUNT) {
        counter.classList.remove('warning');
        counter.classList.add('success');
        submitBtn.disabled = false;
      } else {
        counter.classList.remove('success');
        counter.classList.add('warning');
        submitBtn.disabled = true;
      }
    }

    function getFormData() {
      const categories = Array.from(document.querySelectorAll('input[name="category"]:checked')).map(cb => cb.value);
      const ngFilters = Array.from(document.querySelectorAll('input[name="ngFilter"]:checked')).map(cb => cb.value);
      const getRadioValue = (name) => {
        const checked = document.querySelector(`input[name="${name}"]:checked`);
        return checked ? checked.value : '';
      };

      return {
        companyName: document.getElementById('companyName').value,
        contactName: document.getElementById('contactName').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        businessType: document.getElementById('businessType').value,
        annualRevenue: document.getElementById('annualRevenue').value,
        taxFiled: document.getElementById('taxFiled').value,
        employeeCount: document.getElementById('employeeCount').value,
        categories: categories,
        userType: getRadioValue('userType'),
        concurrentUsers: getRadioValue('concurrentUsers'),
        dataVolume: getRadioValue('dataVolume'),
        processTiming: getRadioValue('processTiming'),
        dataMigration: getRadioValue('dataMigration'),
        designRequirement: getRadioValue('designRequirement'),
        ngFilters: ngFilters,
        description: document.getElementById('description').value
      };
    }

    function showResult(result) {
      document.getElementById('loadingScreen').style.display = 'none';
      document.getElementById('resultScreen').style.display = 'block';

      const iconEl = document.getElementById('resultIcon');
      const titleEl = document.getElementById('resultTitle');
      const messageEl = document.getElementById('resultMessage');

      if (result.judgment === 'OK') {
        iconEl.textContent = 'âœ…';
        titleEl.textContent = 'ç„¡æ–™å¯¾å¿œãŒå¯èƒ½ã§ã™';
        messageEl.innerHTML = 'ãŠå•ã„åˆã‚ã›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚<br>è©³ç´°ç¢ºèªã®ãŸã‚ã€ãƒ¡ãƒ¼ãƒ«ã‚’ãŠé€ã‚Šã—ã¾ã—ãŸã€‚<br>ã”ç¢ºèªã‚’ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚';
      } else if (result.judgment === 'BORDERLINE') {
        iconEl.textContent = 'ğŸ¤”';
        titleEl.textContent = 'ãƒ’ã‚¢ãƒªãƒ³ã‚°ãŒå¿…è¦ã§ã™';
        messageEl.innerHTML = 'ãŠå•ã„åˆã‚ã›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚<br>æ©Ÿèƒ½ã«ã‚ˆã£ã¦ã¯ç„¡æ–™å¯¾å¿œãŒå¯èƒ½ã§ã™ã€‚<br>è©³ç´°ã¯ãƒ¡ãƒ¼ãƒ«ã‚’ã”ç¢ºèªãã ã•ã„ã€‚';
      } else if (result.judgment.includes('æŠ€è¡“åˆ¶ç´„')) {
        iconEl.textContent = 'âš ï¸';
        titleEl.textContent = 'å¯¾å¿œç¯„å›²å¤–ã¨ãªã‚Šã¾ã™';
        messageEl.innerHTML = 'ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚<br>ã”è¦æœ›ã¯å½“ã‚µãƒ¼ãƒ“ã‚¹ã®å¯¾å¿œç¯„å›²å¤–ã§ã™ã€‚<br>è©³ç´°ã¯ãƒ¡ãƒ¼ãƒ«ã‚’ã”ç¢ºèªãã ã•ã„ã€‚';
      } else {
        iconEl.textContent = 'ğŸ“‹';
        titleEl.textContent = 'æœ‰æ–™ãƒ—ãƒ©ãƒ³ã®ã”æ¡ˆå†…';
        messageEl.innerHTML = 'ãŠå•ã„åˆã‚ã›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚<br>ã”è¦æœ›ã¯ç„¡æ–™å¯¾å¿œã®ç¯„å›²ã‚’è¶…ãˆã¦ãŠã‚Šã¾ã™ã€‚<br>è©³ç´°ã¯ãƒ¡ãƒ¼ãƒ«ã‚’ã”ç¢ºèªãã ã•ã„ã€‚';
      }
    }

    function showError(error) {
      document.getElementById('loadingScreen').style.display = 'none';
      document.getElementById('resultScreen').style.display = 'block';
      document.getElementById('resultIcon').textContent = 'âŒ';
      document.getElementById('resultTitle').textContent = 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ';
      document.getElementById('resultMessage').innerHTML = 'ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚<br>ã—ã°ã‚‰ãçµŒã£ã¦ã‹ã‚‰å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚';
    }

    document.getElementById('estimateForm').addEventListener('submit', function(e) {
      e.preventDefault();
      if (!validateStep(currentStep)) return;

      const description = document.getElementById('description').value;
      if (description.length < MIN_CHAR_COUNT) {
        alert(`è©³ç´°èª¬æ˜ã¯${MIN_CHAR_COUNT}æ–‡å­—ä»¥ä¸Šå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚`);
        return;
      }

      document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
      document.getElementById('progressSection').style.display = 'none';
      document.getElementById('loadingScreen').style.display = 'block';

      google.script.run
        .withSuccessHandler(showResult)
        .withFailureHandler(showError)
        .processFormSubmission(getFormData());
    });

    updateCharCounter();
    updateProgress();
  </script>
</body>
</html>
