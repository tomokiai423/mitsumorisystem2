================================================================================
GAS案件 自動見積もりシステム ガイドライン
================================================================================
作成日: 2025年12月17日
更新日: 2025年12月19日
バージョン: v2
合同会社リバイラル システム開発事業部

================================================================================
【1】システム概要
================================================================================

■ このシステムは何？
「無料でシステム開発します」という集客用のお問い合わせフォームです。
AIが自動で工数を判定し、無料対応可能かどうかを自動返信します。

■ 主な機能
・お問い合わせフォーム（お客様が入力）
・AI自動工数判定（Claude APIを使用）
・自動返信メール（判定結果に応じて4パターン）
・Chatwork通知（新規問い合わせを通知）
・管理画面（問い合わせ一覧・ステータス管理）

================================================================================
【2】URL一覧
================================================================================

■ お問い合わせフォーム（お客様に公開するURL）
https://script.google.com/macros/s/AKfycbzsTxf5btUzBw-TzDzQRRuHWZHdKuKWOe76L8pr10lGXvCENC2qcWJMYxJEPGtHfd7G/exec

■ 管理画面（社内用）
https://script.google.com/macros/s/AKfycbzsTxf5btUzBw-TzDzQRRuHWZHdKuKWOe76L8pr10lGXvCENC2qcWJMYxJEPGtHfd7G/exec?page=admin

■ スプレッドシート（データ管理）
https://docs.google.com/spreadsheets/d/1A0QgC425A1yQDoZyg8ieB7sNPsyksH7b1uXrJeAJZL0/edit

================================================================================
【3】システムの流れ
================================================================================

1. お客様がフォームに入力開始（Step1: 確認事項）
   └─ NGフィルターチェック（スマホアプリ等は即時終了）
      ├─ 該当あり → お断りメッセージを表示して終了
      └─ 該当なし → 次のステップへ進む

2. お客様がフォームに入力（Step2〜5）
   ├─ Step2: 顧客情報（会社名、連絡先、事業形態、年商など）
   ├─ Step3: システムカテゴリ選択
   ├─ Step4: 規模感の確認
   └─ Step5: 詳細情報（200文字以上必須）

3. システムが自動で判定
   ├─ 規模感チェック（データ量・利用人数等で工数加算）
   └─ Claude AIが工数を計算

4. 判定結果
   ├─ OK（360分以下）→ 無料対応可能
   ├─ BORDERLINE（361〜480分）→ 要ヒアリング
   └─ NG（481分以上）→ 有料プラン案内

5. 自動処理
   ├─ スプレッドシートに記録
   ├─ お客様に自動返信メール
   └─ Chatworkに通知（OK/BORDERLINEの場合）

================================================================================
【4】フォーム構成
================================================================================

■ Step1: 確認事項（NGフィルター）
該当した場合は即時終了となり、次のステップに進めません。
詳細は【8】判定基準を参照。

■ Step2: 顧客情報
┌─────────────────────┬──────────────────┬─────────────────────────┬──────┐
│ 項目                │ 形式             │ 選択肢/備考             │ 必須 │
├─────────────────────┼──────────────────┼─────────────────────────┼──────┤
│ 会社名              │ テキスト         │ -                       │  ○  │
├─────────────────────┼──────────────────┼─────────────────────────┼──────┤
│ 担当者名            │ テキスト         │ -                       │  ○  │
├─────────────────────┼──────────────────┼─────────────────────────┼──────┤
│ メールアドレス      │ メール           │ -                       │  ○  │
├─────────────────────┼──────────────────┼─────────────────────────┼──────┤
│ 電話番号            │ 電話             │ -                       │  -  │
├─────────────────────┼──────────────────┼─────────────────────────┼──────┤
│ 事業形態            │ ドロップダウン   │ 個人事業主 / 法人       │  ○  │
├─────────────────────┼──────────────────┼─────────────────────────┼──────┤
│ 年商                │ ドロップダウン   │ 下記参照                │  ○  │
├─────────────────────┼──────────────────┼─────────────────────────┼──────┤
│ 決算（確定申告）    │ ドロップダウン   │ はい / いいえ           │  ○  │
│ 済みか              │                  │                         │      │
├─────────────────────┼──────────────────┼─────────────────────────┼──────┤
│ 従業員数            │ 数値入力         │ -                       │  ○  │
│ （アルバイト含む）  │                  │                         │      │
└─────────────────────┴──────────────────┴─────────────────────────┴──────┘

■ 年商の選択肢
・500万円未満
・500万〜1,000万円
・1,000万〜1,500万円
・1,500万〜3,000万円
・3,000万〜5,000万円
・5,000万〜1億円
・1億〜3億円
・3億円以上

※年商・決算の回答内容でNGにはしない（情報収集目的）

■ Step3: システムカテゴリ選択
開発したいシステムの種類を選択（複数選択可）

■ Step4: 規模感の確認
利用者数、データ量などを確認

■ Step5: 詳細情報
・システムの詳細を自由入力
・最低200文字以上必須
・文字数表示あり（例：「現在 150 / 200文字」）
・200文字未満は送信ボタンを押せない

================================================================================
【5】管理画面の使い方
================================================================================

■ アクセス方法
上記の管理画面URLをブラウザで開く

■ 画面の説明
・上部：問い合わせ件数の統計（OK/要ヒアリング/対応不可）
・中央：フィルター（判定結果・ステータスで絞り込み）
・下部：問い合わせ一覧テーブル

■ ステータスの変更方法
1. 一覧の右端「ステータス」列のドロップダウンをクリック
2. 以下から選択：
   ・未対応 → まだ対応していない
   ・対応中 → 対応を進めている
   ・完了 → 対応完了
   ・見送り → 対応しないことに決定

================================================================================
【6】設定の変更方法
================================================================================

設定はスプレッドシートの「設定」シートで変更できます。
※コードの変更は不要です

■ 設定シートの開き方
1. スプレッドシートを開く
2. 下のタブから「設定」をクリック

■ 変更できる項目

┌─────────────────────┬─────────────────────────────────────┐
│ 項目                │ 説明                                │
├─────────────────────┼─────────────────────────────────────┤
│ CLAUDE_API_KEY      │ Claude APIのキー（変更不要）        │
├─────────────────────┼─────────────────────────────────────┤
│ 日程調整URL         │ Calendly等のURL                     │
│                     │ メールに記載されるリンク            │
├─────────────────────┼─────────────────────────────────────┤
│ Chatwork APIトークン│ Chatwork通知用（設定済み）          │
├─────────────────────┼─────────────────────────────────────┤
│ Chatwork ルームID   │ 通知先のルームID（設定済み）        │
├─────────────────────┼─────────────────────────────────────┤
│ 無料対応しきい値    │ この分数以下なら「OK」判定          │
│ （分）              │ 初期値: 360（6時間）                │
├─────────────────────┼─────────────────────────────────────┤
│ 要ヒアリングしきい値│ この分数以下なら「BORDERLINE」判定  │
│ （分）              │ 初期値: 480（8時間）                │
├─────────────────────┼─────────────────────────────────────┤
│ テストモード        │ TRUE: メール送信しない（テスト用）  │
│                     │ FALSE: メール送信する（本番用）     │
└─────────────────────┴─────────────────────────────────────┘

================================================================================
【7】テストモードと本番モード
================================================================================

■ テストモード（TRUE）
・メールは送信されない
・その他の機能（記録・通知・管理画面）は動作する
・フォームのテストや動作確認に使用

■ 本番モード（FALSE）
・メールが実際に送信される
・お客様に公開する前に設定

■ 切り替え方法
1. スプレッドシートの「設定」シートを開く
2.「テストモード」のB列を変更
   TRUE → FALSE（本番開始）
   FALSE → TRUE（テストに戻す）

================================================================================
【8】判定基準
================================================================================

■ NGフィルター（Step1で即時終了）
以下に該当すると、フォーム入力開始時（Step1）でお断りメッセージを表示し、
次のステップには進めません：
・スマホアプリ（ネイティブ）が必要
・社外に一般公開するシステム
・既存システム（kintone、Salesforce等）の改修
・リアルタイム同期が必須（チャット、在庫同期等）
・Google Workspace外のユーザーも利用

■ お断りメッセージ（NGフィルター該当時）
┌─────────────────────────────────────────────────────┐
│ 申し訳ございません。                                │
│                                                     │
│ ご選択いただいた内容は、当サービスの対応範囲外と    │
│ なっております。                                    │
│                                                     │
│ 当サービスはGoogle Apps Script（GAS）を活用した     │
│ 業務効率化ツールの開発に特化しております。          │
│                                                     │
│ ご期待に沿えず恐れ入りますが、                      │
│ 何卒ご理解いただけますと幸いです。                  │
└─────────────────────────────────────────────────────┘

■ 規模感による工数加算
┌─────────────────────────┬───────────┐
│ 条件                    │ 追加工数  │
├─────────────────────────┼───────────┤
│ データ量が1万行以上     │ +60分     │
│ 同時利用人数が数十人以上│ +45分     │
│ リアルタイム処理が必須  │ +90分     │
│ 大量データ移行あり      │ +60分     │
│ デザインにこだわりたい  │ +60分     │
│ 社外（取引先等）も利用  │ +45分     │
└─────────────────────────┴───────────┘

■ 判定結果
┌─────────────┬─────────────┬─────────────────────────┐
│ 判定        │ 工数        │ 対応                    │
├─────────────┼─────────────┼─────────────────────────┤
│ OK          │ 360分以下   │ 無料対応可能            │
│ BORDERLINE  │ 361〜480分  │ 要ヒアリング・機能削減  │
│ NG          │ 481分以上   │ 有料プラン案内          │
└─────────────┴─────────────┴─────────────────────────┘

================================================================================
【9】自動返信メールのパターン
================================================================================

■ パターンA: 無料対応OK
件名: 【無料対応可能】システム開発のお申込みありがとうございます
内容: 無料対応が可能です。日程調整URLからヒアリング予約をお願いします。

■ パターンB: 要ヒアリング
件名: 【ご相談】システム開発のお申込みについて
内容: 機能によっては無料対応が可能です。詳細をお伺いさせてください。

■ パターンC: 対応不可（工数オーバー）
件名: 【有料プランのご案内】システム開発のお申込みについて
内容: 無料対応の範囲を超えています。有料プランをご案内します。

■ パターンD: 対応不可（技術制約）
件名: 【ご案内】システム開発のお申込みについて
内容: 当サービスの対応範囲外となります。理由を記載。

※メール文面は「メールテンプレート」シートで変更可能

================================================================================
【10】メールテンプレートの変更方法
================================================================================

1. スプレッドシートを開く
2. 下のタブから「メールテンプレート」をクリック
3. 変更したい行のB列（件名）またはC列（本文）を編集

■ 使用できる変数（自動で置き換わる）
・{{会社名}} → お客様の会社名
・{{担当者名}} → お客様の担当者名
・{{日程調整URL}} → 設定シートのURL
・{{NG理由}} → 対応不可の理由

================================================================================
【11】トラブルシューティング
================================================================================

■ メールが届かない
→ 設定シートの「テストモード」が「TRUE」になっていないか確認
→「FALSE」になっていれば本番モード

■ Chatwork通知が届かない
→ 設定シートの「Chatwork APIトークン」と「ルームID」を確認
→ 判定結果が「NG」の場合は通知されない仕様

■ 管理画面にデータが表示されない
→ ブラウザを更新（F5キー）
→ 別のブラウザで試す

■ フォームでエラーが出る
→ Apps Scriptの権限が切れている可能性
→ システム管理者に連絡

■ 古いフォームが表示される
→ ブラウザのキャッシュをクリア（Ctrl+Shift+R）
→ シークレットモードで開いてみる（Ctrl+Shift+N）

================================================================================
【12】スプレッドシートの列構成
================================================================================

■ 「問い合わせ一覧」シートの列構成（全22列）

┌────┬──────────────────┬────────────────────────────────┐
│ 列 │ ヘッダー名       │ 説明                           │
├────┼──────────────────┼────────────────────────────────┤
│ A  │ タイムスタンプ   │ 送信日時                       │
│ B  │ 会社名           │ 顧客の会社名                   │
│ C  │ 担当者名         │ 顧客の担当者名                 │
│ D  │ メールアドレス   │ 顧客のメールアドレス           │
│ E  │ 電話番号         │ 顧客の電話番号                 │
│ F  │ 事業形態         │ 個人事業主 / 法人              │
│ G  │ 年商             │ 選択肢から選択された値         │
│ H  │ 決算済みか       │ はい / いいえ                  │
│ I  │ 従業員数         │ アルバイト含む                 │
│ J  │ カテゴリ         │ システムカテゴリ               │
│ K  │ 利用者           │ 利用者の範囲                   │
│ L  │ 同時利用人数     │ 同時に利用する人数             │
│ M  │ 想定データ量     │ 扱うデータの量                 │
│ N  │ 処理タイミング   │ リアルタイム/バッチ            │
│ O  │ 既存データ移行   │ データ移行の有無               │
│ P  │ デザイン要件     │ デザインへのこだわり           │
│ Q  │ NGフィルター     │ 該当したNGフィルター項目       │
│ R  │ 詳細             │ 自由入力された詳細情報         │
│ S  │ 判定結果         │ OK / BORDERLINE / NG           │
│ T  │ 工数（分）       │ AIが算出した工数               │
│ U  │ 理由             │ 判定理由                       │
│ V  │ ステータス       │ 未対応/対応中/完了/見送り      │
└────┴──────────────────┴────────────────────────────────┘

※F〜I列（事業形態・年商・決算済みか・従業員数）は情報収集目的。
  NGフィルターには使用されません。

================================================================================
【13】ファイル保存場所
================================================================================

システムのコードファイルは以下に保存されています：
C:\Users\music008\Documents\GAS見積もりシステム

■ ファイル一覧
・01_スプレッドシート初期設定.gs
・02_メインコード_v7.gs（最新版）
・03_フォーム_v4.html（最新版・モダンデザイン）
・04_Claude API連携.gs
・05_Chatwork通知_v2.gs
・06_管理画面_v3.html
・07_設定シート追加.gs
・08_テスト管理画面.html
・ガイドライン_v2.txt（このファイル）

================================================================================
【14】問い合わせ先
================================================================================

システムについて不明点があれば、システム管理者にお問い合わせください。

================================================================================
【15】更新履歴
================================================================================

■ v2（2025年12月19日）
・フォームURLを新しいデプロイに更新
・フォームをモダンデザイン（v4）に更新
・NGフィルターをStep1に移動（該当時は即時終了）
・顧客情報に4項目追加（事業形態・年商・決算・従業員数）
・詳細情報を200文字以上必須に変更
・スプレッドシート列構成の詳細を追加
・ファイル一覧を最新版に更新

■ v1（2025年12月17日）
・初版作成

================================================================================
以上
================================================================================
